<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Favoritos</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * { box-sizing: border-box; }
    body { font-family: sans-serif; margin: 0; background: #f4f4f4; }
    .top-bar {
      position: sticky;
      top: 0;
      background: white;
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      align-items: center;
      padding: 10px 20px;
      gap: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      z-index: 1000;
    }
    .btn {
      background: #01b9b5;
      color: white;
      text-decoration: none;
      padding: 8px 14px;
      border-radius: 6px;
      font-size: 14px;
      cursor: pointer;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(1, 1fr);
      gap: 20px;
      padding: 20px;
    }
    @media (min-width: 768px) {
      .grid {
        grid-template-columns: repeat(3, 1fr);
      }
    }
    .card {
      background: white;
      padding: 10px;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      text-align: center;
      position: relative;
    }
    .card img {
      width: 100%;
      border-radius: 8px;
    }
    .card span {
      display: block;
      margin-top: 8px;
      font-weight: bold;
    }
    .checkbox-select {
      position: absolute;
      top: 10px;
      left: 10px;
      transform: scale(1.5);
    }
    .empty-msg {
      text-align: center;
      margin: 40px;
      font-size: 18px;
      color: #888;
    }
    .bottom-warning {
      text-align: center;
      margin: 30px;
      font-weight: bold;
      color: red;
    }
  </style>
</head>
<body>
  <div class="top-bar">
    <a href="https://catalogo.artspapeisdeparede.com.br/index.html" class="btn">‚Üê Voltar</a>
    <button class="btn" onclick="selecionarTodos()">Selecionar todos</button>
    <button class="btn" onclick="desmarcarTodos()">Desmarcar todos</button>
    <button class="btn" onclick="removerSelecionadas()">üíî Remover selecionadas</button>
    <button class="btn" onclick="baixarSelecionadas()">üì• Baixar selecionadas</button>
  </div>

  <div class="grid" id="galeria"></div>

  <p class="empty-msg" id="mensagem-vazio" style="display: none;">
    Adicione modelos aos favoritos e veja todos os seus modelos aqui.
  </p>

  <p class="bottom-warning">
    ATEN√á√ÉO! Encaminhe suas imagens favoritas antes de fechar o navegador. Ao fechar o navegador voc√™ perder√° seus favoritos.
  </p>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const galeria = document.getElementById('galeria');
      const msgVazio = document.getElementById('mensagem-vazio');
      let favoritos = JSON.parse(localStorage.getItem('favoritos')) || [];

      favoritos = favoritos.sort((a, b) => a.localeCompare(b));

      if (favoritos.length === 0) {
        msgVazio.style.display = 'block';
        return;
      }

      favoritos.forEach(src => {
        const nome = src.split('/').pop().replace(/\.[^.]+$/, '').replace(/[-_\s]*(\d+)$/, '').replace(/\(\d+\)$/, '');
        const card = document.createElement('div');
        card.className = 'card';

        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.className = 'checkbox-select';
        checkbox.value = src;

        const img = document.createElement('img');
        img.src = src;
        const span = document.createElement('span');
        span.textContent = nome;

        card.appendChild(checkbox);
        card.appendChild(img);
        card.appendChild(span);
        galeria.appendChild(card);
      });
    });

    function selecionarTodos() {
      document.querySelectorAll('.checkbox-select').forEach(cb => cb.checked = true);
    }

    function desmarcarTodos() {
      document.querySelectorAll('.checkbox-select').forEach(cb => cb.checked = false);
    }

    function removerSelecionadas() {
      const selecionadas = Array.from(document.querySelectorAll('.checkbox-select:checked')).map(cb => cb.value);
      if (selecionadas.length === 0) return alert('Nenhuma imagem selecionada.');
      let favoritos = JSON.parse(localStorage.getItem('favoritos')) || [];
      favoritos = favoritos.filter(item => !selecionadas.includes(item));
      localStorage.setItem('favoritos', JSON.stringify(favoritos));
      location.reload();
    }

    function baixarSelecionadas() {
      const selecionadas = Array.from(document.querySelectorAll('.checkbox-select:checked')).map(cb => cb.value);
      if (selecionadas.length === 0) return alert("Nenhuma imagem selecionada.");
      selecionadas.forEach(src => {
        const link = document.createElement('a');
        link.href = src;
        link.download = src.split('/').pop();
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      });
    }
  </script>
</body>
</html>
